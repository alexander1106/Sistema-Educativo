<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Examen de Presupuesto y Ahorro</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f0f0f0;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
      }
      .question {
        margin-bottom: 20px;
      }
      .question h3 {
        margin-bottom: 10px;
      }
      .result {
        margin-top: 20px;
        padding: 10px;
        background-color: #e0ffe0;
        border: 1px solid #00c000;
        display: none;
      }
      .error {
        display: none;
        color: red;
      }
      button {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        font-size: 16px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      button:hover {
        background-color: #0056b3;
      }
      .correct {
        color: green;
      }
      .incorrect {
        color: red;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Examen del modulo Ahorrando para cumplir mis metas</h1>
      <form id="quizForm">
        <div class="question" id="q1">
          <h3>
            1. ¿Cuál es el primer paso para crear un presupuesto efectivo?
          </h3>
          <label
            ><input type="radio" name="q1" value="a" /> a) Identificar todos los
            ingresos y gastos.</label
          ><br />
          <label
            ><input type="radio" name="q1" value="b" /> b) Ahorrar el 10% de los
            ingresos.</label
          ><br />
          <label
            ><input type="radio" name="q1" value="c" /> c) Invertir en la bolsa
            de valores.</label
          >
        </div>
        <div class="question" id="q2">
          <h3>
            2. ¿Qué porcentaje de tus ingresos recomiendan los expertos ahorrar
            cada mes?
          </h3>
          <label><input type="radio" name="q2" value="a" /> a) 5%</label><br />
          <label><input type="radio" name="q2" value="b" /> b) 10%</label><br />
          <label><input type="radio" name="q2" value="c" /> c) 20%</label>
        </div>
        <div class="question" id="q3">
          <h3>3. ¿Cuál de los siguientes es un gasto fijo?</h3>
          <label><input type="radio" name="q3" value="a" /> a) Ropa</label
          ><br />
          <label
            ><input type="radio" name="q3" value="b" /> b) Renta o
            hipoteca</label
          ><br />
          <label
            ><input type="radio" name="q3" value="c" /> c)
            Entretenimiento</label
          >
        </div>
        <div class="question" id="q4">
          <h3>4. ¿Qué es un fondo de emergencia?</h3>
          <label
            ><input type="radio" name="q4" value="a" /> a) Dinero guardado para
            compras imprevistas.</label
          ><br />
          <label
            ><input type="radio" name="q4" value="b" /> b) Dinero reservado para
            emergencias médicas.</label
          ><br />
          <label
            ><input type="radio" name="q4" value="c" /> c) Ahorros equivalentes
            a 3-6 meses de gastos esenciales.</label
          >
        </div>
        <div class="question" id="q5">
          <h3>5. ¿Cuál es la mejor forma de reducir los gastos variables?</h3>
          <label
            ><input type="radio" name="q5" value="a" /> a) Reducir el pago de la
            hipoteca.</label
          ><br />
          <label
            ><input type="radio" name="q5" value="b" /> b) Comer fuera de casa
            menos frecuentemente.</label
          ><br />
          <label
            ><input type="radio" name="q5" value="c" /> c) Aumentar los
            ingresos.</label
          >
        </div>
        <div class="question" id="q6">
          <h3>6. ¿Qué es el "ahorro automatizado"?</h3>
          <label
            ><input type="radio" name="q6" value="a" /> a) Transferir
            manualmente dinero a una cuenta de ahorros cada mes.</label
          ><br />
          <label
            ><input type="radio" name="q6" value="b" /> b) Configurar
            transferencias automáticas a una cuenta de ahorros.</label
          ><br />
          <label
            ><input type="radio" name="q6" value="c" /> c) Guardar dinero en
            efectivo en casa.</label
          >
        </div>
        <div class="question" id="q7">
          <h3>7. ¿Cuál es la ventaja principal de tener un presupuesto?</h3>
          <label
            ><input type="radio" name="q7" value="a" /> a) Aumenta
            automáticamente los ingresos.</label
          ><br />
          <label
            ><input type="radio" name="q7" value="b" /> b) Ayuda a tomar
            decisiones financieras informadas.</label
          ><br />
          <label
            ><input type="radio" name="q7" value="c" /> c) Elimina todos los
            gastos.</label
          >
        </div>
        <div class="question" id="q8">
          <h3>8. ¿Qué significa vivir dentro de tus posibilidades?</h3>
          <label
            ><input type="radio" name="q8" value="a" /> a) Gastar menos de lo
            que ganas.</label
          ><br />
          <label
            ><input type="radio" name="q8" value="b" /> b) Utilizar tarjetas de
            crédito para todas las compras.</label
          ><br />
          <label
            ><input type="radio" name="q8" value="c" /> c) Pedir prestado para
            cubrir gastos mensuales.</label
          >
        </div>
        <div class="question" id="q9">
          <h3>9. ¿Cuál es una estrategia efectiva para ahorrar dinero?</h3>
          <label
            ><input type="radio" name="q9" value="a" /> a) Comprar
            impulsivamente.</label
          ><br />
          <label
            ><input type="radio" name="q9" value="b" /> b) Comparar precios y
            buscar descuentos.</label
          ><br />
          <label
            ><input type="radio" name="q9" value="c" /> c) No llevar registro de
            los gastos.</label
          >
        </div>
        <div class="question" id="q10">
          <h3>10. ¿Qué debería incluirse en un presupuesto mensual?</h3>
          <label
            ><input type="radio" name="q10" value="a" /> a) Solo los
            ingresos.</label
          ><br />
          <label
            ><input type="radio" name="q10" value="b" /> b) Solo los
            gastos.</label
          ><br />
          <label
            ><input type="radio" name="q10" value="c" /> c) Ingresos, gastos y
            ahorros.</label
          >
        </div>
        <div class="error" id="error">
          Por favor, responde todas las preguntas antes de evaluar.
        </div>
        <button type="button" onclick="evaluateQuiz()">Evaluar</button>
      </form>
      <div class="result" id="result"></div>
    </div>

    <script>
      const correctAnswers = {
        q1: "a",
        q2: "c",
        q3: "b",
        q4: "c",
        q5: "b",
        q6: "b",
        q7: "b",
        q8: "a",
        q9: "b",
        q10: "c",
      };

      function evaluateQuiz() {
        let form = document.getElementById("quizForm");
        let resultDiv = document.getElementById("result");
        let errorDiv = document.getElementById("error");
        let formData = new FormData(form);
        let correctCount = 0;
        let totalQuestions = 10;

        let answeredQuestions = {};
        for (let [name, value] of formData.entries()) {
          answeredQuestions[name] = value;
        }

        if (Object.keys(answeredQuestions).length < totalQuestions) {
          errorDiv.style.display = "block";
          resultDiv.style.display = "none";
        } else {
          errorDiv.style.display = "none";
          resultDiv.innerHTML = "";
          let questionResult = "";

          for (let i = 1; i <= totalQuestions; i++) {
            let questionName = `q${i}`;
            let userAnswer = answeredQuestions[questionName];
            let correctAnswer = correctAnswers[questionName];

            if (userAnswer === correctAnswer) {
              correctCount++;
              questionResult += `<p class="correct">Pregunta ${i}: Correcta</p>`;
            } else {
              questionResult += `<p class="incorrect">Pregunta ${i}: Incorrecta (Tu respuesta: ${userAnswer}, Respuesta correcta: ${correctAnswer})</p>`;
            }
          }

          let incorrectCount = totalQuestions - correctCount;
          let score = correctCount * 2;

          resultDiv.innerHTML += `<p>Preguntas correctas: ${correctCount}</p>
                                   <p>Preguntas incorrectas: ${incorrectCount}</p>
                                   <p>Calificación: ${score}</p>
                                   ${questionResult}`;
          resultDiv.style.display = "block";

          // Call function to send the score to the database
          sendScoreToDatabase(score);
        }
      }

      function sendScoreToDatabase(score) {
        const idUsuario = localStorage.getItem("idUsuario");
        const moduloId = "modulo-presupuesto-ahorro";

        const data = {
          idUsuario: idUsuario,
          moduloId: moduloId,
          notamodulo: score,
        };

        fetch("http://api.bluetabdemo.site/api/registrarmodulo", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => {
            if (response.ok) {
              return response.json(); // Procesar la respuesta si todo está bien
            }
            throw new Error("Error al enviar datos"); // Lanzar un error si hay problemas con la solicitud
          })
          .then((data) => {
            console.log("Respuesta del servidor:", data);
            alert("Calificación enviada correctamente.");
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("Ocurrió un error al enviar la calificación.");
          });
      }
    </script>
  </body>
</html>
